{% extends 'boutique/base.html' %}

{% block content %}

<!-- if a subcategory specified -->
{% if subcategory_shown %}

    <div class="mt-5 text-center mb-3 mb-md-5">
    {% if subcategory_shown.item_set.count == 0 %}

        <h4 class="mb-3 pb-1 text-muted border-bottom text-center font-weight-lighter">More {{subcategory_shown}} are coming...</h4>
        <p class="font-weight-lighter text-muted mb-5">Feel free to browse some other product</p>
        
    {% else %}

        <h4 class="mb-3 pb-1 border-bottom font-weight-light"><a class="text-dark" href="{{subcategory_shown.category.get_category_url}}">{{subcategory_shown.category}}</a></h4>
        <div class="container px-2">
            <h6 class="my-3 pb-1 border-bottom border-light font-weight-lighter"><a class="text-dark" href="{{subcategory_shown.get_subcategory_url}}">{{subcategory_shown.name}}</a></h6>
            <!-- {% if subcategory_shown.description %}
                <p class="mt-n3 mb-4 px-3"><small class="font-weight-lighter">{{subcategory_shown.description}}</small></p>
            {% endif %} -->
            <div class="row">
                {% for item in item_list %}

                    {% include 'boutique/include/item_in_items.html' %}
                    
                {% endfor %}
            </div>
        </div>
        
    {% endif %}
    </div>

<!-- if no subcategory specified, only category/ies specified -->
{% else %}

    <!-- iterate through category_shown -->
    {% for category in category_shown %}

        <div class="mt-5 text-center mb-3 mb-md-5">
        <!-- if there's only one category to be shown but no items in it -->
        {% if category.item_set.count == 0 and category_shown.count == 1 %}

                <h4 class="mb-3 pb-1 text-muted border-bottom text-center font-weight-lighter">More {{category}} are coming...</h4>
                <p class="font-weight-lighter text-muted mb-5">Feel free to browse some other product</p>

        <!-- skip to the next category if there's no items in this category-->
        {% else %}
        {% if category.item_set.count > 0  %}
            <h4 class="mb-3 pb-1 border-bottom font-weight-light"><a class="text-dark" href="{{category.get_category_url}}">{{category}}</a></h4>
            {% if category.description %}
            <p class="mt-n2 mb-4 px-3"><small class="font-weight-lighter">{{category.description}}</small></p>
            {% endif %}
            <!-- when this category has subcategories -->
            {% if category.subcategory_set.count > 0 %}

                <div class="container px-2">

                    <!-- subcategory iteration -->
                    {% for subcategory in category.subcategory_set.all %}

                        <!-- if there's no items under this subcategory, skip to the next subcategory -->
                        {% if subcategory.item_set.count > 0 %}

                            <h6 class="my-3 pb-1 border-bottom border-light font-weight-lighter"><a class="text-dark" href="{{subcategory.get_subcategory_url}}">{{subcategory.name}}</a></h6>
                            <!-- {% if subcategory.description %}
                                <p class="mt-n3 mb-4 px-3"><small class="font-weight-lighter">{{subcategory.description}}</small></p>
                            {% endif %} -->
                            <div class="row">
                                {% for item in subcategory.item_set.all %}

                                    {% include 'boutique/include/item_in_items.html' %}

                                {% endfor %}
                            </div>

                        {% endif %}
                        <!-- / if there's no items under this subcategory, skip to the next subcategory -->
                        
                    {% endfor %}
                    <!-- / subcategory iteration -->

                </div>

            <!-- when this category does not have a subcategory -->
            {% else %}

                <div class="container px-2">
                    <div class="row">
                        {% for item in category.item_set.all %}

                            {% include 'boutique/include/item_in_items.html' %}

                        {% endfor %}
                    </div>
                </div>

            {% endif %}
            <!-- / this category has subcategories or not -->
        </div>

        {% endif %}
        {% endif %}
        <!-- / if there's no items in this category, skip to the next category -->
    {% endfor %}
    <!-- / iterate through category_shown -->

{% endif %}
<!-- / a subcategory specified or not -->

{% include 'boutique/include/pagination.html' %}

<hr class="mt-3">

{% include 'boutique/include/before_footer.html' %}

{% endblock content %}